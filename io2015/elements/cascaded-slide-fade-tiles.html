<!--
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/paper-styles/paper-styles.html">
<link rel="import" href="../components/neon-animation/neon-shared-element-animatable-behavior.html">

<dom-module id="cascaded-slide-fade-tiles">

  <style>

    :host {
      display: block;
    }

  </style>

  <template>

    <content></content>

  </template>

  <script>

    Polymer({

      is: 'cascaded-slide-fade-tiles',

      behaviors: [
        Polymer.NeonSharedElementAnimatableBehavior
      ],

      properties: {

        _animationConfig: {
          value: function() {
            return {
              'entry': [{
                name: 'cascaded-animation',
                animation: 'transform-animation',
                transformFrom: 'translateY(100%)',
                transformTo: 'none',
                nodeDelay: 10,
                timing: {
                  delay: 100
                }
              },{
                name: 'cascaded-animation',
                animation: 'fade-in-animation',
                nodeDelay: 10,
                timing: {
                  delay: 100
                }
              },{
                name: 'fade-in-animation',
                timing: {
                  delay: 100
                }
              }],

              'exit': [{
                name: 'cascaded-animation',
                animation: 'transform-animation',
                transformFrom: 'translateY(0)',
                transformTo: 'translateY(100%)',
                nodeDelay: 10
              },{
                name: 'cascaded-animation',
                animation: 'fade-out-animation',
                nodeDelay: 10
              },{
                name: 'fade-out-animation',
              }]
            };
          }
        }
      },

      attached: function() {
        this._updateNodes();
      },

      _updateNodes: function() {
        // slide animation
        var nodes = Polymer.dom(this).querySelectorAll('paper-material, [slide]');
        var slideEntryNodes = Array.prototype.slice.call(nodes);
        var slideExitNodes = Array.prototype.slice.call(nodes);
        slideExitNodes.reverse();
        this._animationConfig['entry'][0].nodes = slideEntryNodes;
        this._animationConfig['entry'][1].nodes = slideEntryNodes;
        this._animationConfig['exit'][0].nodes = slideExitNodes;
        this._animationConfig['exit'][1].nodes = slideExitNodes;
        // fade animation
        var node = Polymer.dom(this).querySelector('[fade]');
        this._animationConfig['entry'][2].node = node;
        this._animationConfig['exit'][2].node = node;
      }

    });

  </script>

</dom-module>
